<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>type cast | 1ms Faster</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/more.png">
    <meta name="description" content="Software performace profile/analysis/optimization">
    <meta name="keywords" content="optimization, analysis, profile, performance, latency, throughput, metrics, linux, cache, CPU, architecture">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.e5fe63c7.css" as="style"><link rel="preload" href="/assets/js/app.0156df4b.js" as="script"><link rel="preload" href="/assets/js/2.0eed2333.js" as="script"><link rel="preload" href="/assets/js/3.1c18827c.js" as="script"><link rel="preload" href="/assets/js/10.20339081.js" as="script"><link rel="prefetch" href="/assets/js/11.9e667a20.js"><link rel="prefetch" href="/assets/js/12.e10ed919.js"><link rel="prefetch" href="/assets/js/13.5b153336.js"><link rel="prefetch" href="/assets/js/14.c9818bab.js"><link rel="prefetch" href="/assets/js/15.e1d4e55a.js"><link rel="prefetch" href="/assets/js/16.b5733294.js"><link rel="prefetch" href="/assets/js/17.6ebbc744.js"><link rel="prefetch" href="/assets/js/18.70850c97.js"><link rel="prefetch" href="/assets/js/19.58d5cecb.js"><link rel="prefetch" href="/assets/js/20.8bcfd87e.js"><link rel="prefetch" href="/assets/js/21.b607bcc6.js"><link rel="prefetch" href="/assets/js/22.bbfb5196.js"><link rel="prefetch" href="/assets/js/23.ca136498.js"><link rel="prefetch" href="/assets/js/24.c1071b43.js"><link rel="prefetch" href="/assets/js/25.6ce26b28.js"><link rel="prefetch" href="/assets/js/26.458ab7f2.js"><link rel="prefetch" href="/assets/js/27.f7c3a9aa.js"><link rel="prefetch" href="/assets/js/28.17e2f19b.js"><link rel="prefetch" href="/assets/js/29.0a5e6199.js"><link rel="prefetch" href="/assets/js/30.c0596552.js"><link rel="prefetch" href="/assets/js/31.df994b91.js"><link rel="prefetch" href="/assets/js/32.630e34e4.js"><link rel="prefetch" href="/assets/js/33.e7b9c15b.js"><link rel="prefetch" href="/assets/js/34.28850efd.js"><link rel="prefetch" href="/assets/js/35.d59ef49e.js"><link rel="prefetch" href="/assets/js/36.85959914.js"><link rel="prefetch" href="/assets/js/4.0f2ca733.js"><link rel="prefetch" href="/assets/js/5.d89070b9.js"><link rel="prefetch" href="/assets/js/6.1e60fa96.js"><link rel="prefetch" href="/assets/js/7.77c61ade.js"><link rel="prefetch" href="/assets/js/8.9251176b.js"><link rel="prefetch" href="/assets/js/9.77bda456.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e5fe63c7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">1ms Faster</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Wiki" class="dropdown-title"><a href="/wiki/" class="link-title">Wiki</a> <span class="title" style="display:none;">Wiki</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Program</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/lean_in_c++/" class="nav-link">Lean in C++</a></li></ul></li><li class="dropdown-item"><h4>Perfromance Engineering</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Performance_Engineering/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>Reading Note</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Reading_Notes/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>ComputeArch</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>Compiler</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>System</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/authoring/" class="nav-link">Authoring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li></ul></div></div> <a href="https://github.com/Quincy-J" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/github_profile_2_1.jpg"> <div class="blogger-info"><h3>Quincy Jet</h3> <span>We are.</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Wiki" class="dropdown-title"><a href="/wiki/" class="link-title">Wiki</a> <span class="title" style="display:none;">Wiki</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Program</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/lean_in_c++/" class="nav-link">Lean in C++</a></li></ul></li><li class="dropdown-item"><h4>Perfromance Engineering</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Performance_Engineering/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>Reading Note</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Reading_Notes/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>ComputeArch</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>Compiler</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>System</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/409de3/404" class="nav-link">[_]</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/authoring/" class="nav-link">Authoring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li></ul></div></div> <a href="https://github.com/Quincy-J" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Lean in c++</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/lean_in_c++/" class="sidebar-link">Lean in C++</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Phase_0:Glimpse</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/8744f7/" class="sidebar-link">C++ Glimpse</a></li><li><a href="/pages/409de3/" aria-current="page" class="active sidebar-link">type cast</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/409de3/#隐式转换" class="sidebar-link">隐式转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/409de3/#整型提升" class="sidebar-link">整型提升</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/409de3/#显式转换" class="sidebar-link">显式转换</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/409de3/#static-cast" class="sidebar-link">static_cast</a></li><li class="sidebar-sub-header level3"><a href="/pages/409de3/#dynamic-cast" class="sidebar-link">dynamic_cast</a></li><li class="sidebar-sub-header level3"><a href="/pages/409de3/#reinterpret-cast" class="sidebar-link">reinterpret_cast</a></li><li class="sidebar-sub-header level3"><a href="/pages/409de3/#const-cast" class="sidebar-link">const_cast</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/409de3/#c语言中的强制类型转换" class="sidebar-link">C语言中的强制类型转换</a></li><li class="sidebar-sub-header level2"><a href="/pages/409de3/#summary" class="sidebar-link">Summary</a></li><li class="sidebar-sub-header level2"><a href="/pages/409de3/#static-cast-一些将会导致错误的情况。" class="sidebar-link">static_cast 一些将会导致错误的情况。</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/pages/409de3/#泛型-generic-types" class="sidebar-link">泛型(Generic Types)</a></li><li class="sidebar-sub-header level4"><a href="/pages/409de3/#指针类型-pointer-types" class="sidebar-link">指针类型(Pointer Types)``</a></li><li class="sidebar-sub-header level5"><a href="/pages/409de3/#情况1-两个无关的类之间的转换" class="sidebar-link">情况1：两个无关的类之间的转换</a></li><li class="sidebar-sub-header level5"><a href="/pages/409de3/#情况2-转换到相关的类" class="sidebar-link">情况2：转换到相关的类</a></li><li class="sidebar-sub-header level5"><a href="/pages/409de3/#情况3-void之间的向前和向后转换" class="sidebar-link">情况3：void之间的向前和向后转换</a></li></ul></li></ul></li><li><a href="/pages/ab4daf/" class="sidebar-link">typedef</a></li><li><a href="/pages/2b0a8f/" class="sidebar-link">class vs. typename</a></li><li><a href="/pages/b9de04/" class="sidebar-link">const</a></li><li><a href="/pages/5bac8e/" class="sidebar-link">extern</a></li><li><a href="/pages/c08a6e/" class="sidebar-link">pointer</a></li><li><a href="/pages/9b131d/" class="sidebar-link">static</a></li><li><a href="/pages/598385/" class="sidebar-link">volatile</a></li><li><a href="/pages/91242f/" class="sidebar-link">inline</a></li><li><a href="/pages/efbaf4/" class="sidebar-link">assert</a></li><li><a href="/pages/b4d0b6/" class="sidebar-link">void</a></li><li><a href="/pages/fc5419/" class="sidebar-link">__global__</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Performance Engineering</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Misc</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Reading Notes</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/wiki/#Wiki" data-v-06970110>Wiki</a></li><li data-v-06970110><a href="/wiki/#Lean in c++" data-v-06970110>Lean in c++</a></li><li data-v-06970110><a href="/wiki/#Phase_0:Glimpse" data-v-06970110>Phase_0:Glimpse</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/Quincy-J" target="_blank" title="作者" class="beLink" data-v-06970110>Quincy Jet</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2021-08-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">Content</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">type cast<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>C++中的类型转换， 四种cast: static_cast、dynamic_cast、const_cast和reinterpret_cast, 以及其他转换方法</p> <h2 id="隐式转换"><a href="#隐式转换" class="header-anchor">#</a> 隐式转换</h2> <p>在不同类型之间进行赋值，其根据类型不同得到不同的结果，如下为基本的转换规则:</p> <ol><li><p>非布尔-&gt;布尔：0-&gt;false; 非0-&gt;true</p></li> <li><p>布尔-&gt;非布尔：false-&gt;0; true-&gt;1</p></li> <li><p>浮点-&gt;整数：近似处理，保留浮点数小数点之前的部分</p></li> <li><p>整数-&gt;浮点数：小数部分记为0，如果整数所占空间超过浮点类型容量，精度会产生损失</p></li> <li><p>给无符号类型一个超过其表示范围的值时，结果是初始值对无符号类型表示数值的总数取模以后的余数。例如unsigned char(8 bit) 可以表示0-255，如果赋一个区间以外的值，则实际结果为该值对256取模所得的余数。unsigned char x = -1; // x = 255</p></li> <li><p>当赋给带符号类型一个超过其表示范围的值时，结果是未定义的。此时程序可能继续工作、可能崩溃，也可能产生垃圾数据（未定义）</p></li> <li><p>无符号数转换为更大的数据类型时, 只需简单地在开头添加0，这种运算称为0扩展</p></li> <li><p>将有符号数转换为更大的数据类型需要执行符号扩展，规则是将当前数符号位扩展至所需要的位数</p></li> <li><p>当数据类型转换时，同时需要在不同数据大小，以及无符号和有符号之间转换时，C语言标准要求先进行数据大小的转换，之后再进行无符号和有符号之间的转换。C语言中的强制类型转换保持二进制位值不变，只是改变解释位的方式。</p></li> <li><p>将一个大的数据类型转换为小的数据类型时，不管是无符号数还是有符号数都是简单地进行位截断</p></li> <li><p>进行整数的算术运算时，当结果变量的位数不足以存放实际实际结果的位数时，运算的结果就会因截断而产生溢出</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;limits&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">bool</span> bValue <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> cValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">short</span> sValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">short</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> iValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> lValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">long</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> llValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">long</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> fValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> dValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> <span class="token keyword">double</span> ldValue <span class="token operator">=</span> <span class="token class-name">numeric_limits</span><span class="token operator">&lt;</span><span class="token keyword">long</span> <span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token double-colon punctuation">::</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//测试开始</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>cValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>sValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>iValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>lValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>llValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>fValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>dValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bValue<span class="token operator">=</span>ldValue<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>以上输出为全1。</p></li></ol> <h3 id="整型提升"><a href="#整型提升" class="header-anchor">#</a> 整型提升</h3> <p>负责把小整数装换成较大的整数类型，</p> <p>对于bool、char、signed char、unsigned char、short、unisned short等类型，只要他们所有可能的值都能存在int类型中，就会提升为int，否则提升为unsigned int。</p> <p>wchar_t、char16_t、char32_6提升成int、unsigned int、long、unsigned long、long long、unsigned long long中最小的一种，前提是能容纳原始类型所有可能的值</p> <p>无符号与有符号之间的转换有几种情况：</p> <ol><li>如果无符号类型不小于带符号类型，则有符号类型转换成无符号类型，如int需要转换成unsigned int。如果有符号是负数，则取模运算</li> <li>如果带符号大于无符号且带符号类型可以容纳所有无符号值，则转换成带符号，否则转换成无符号。比如long和unsigned int，如果int和long大小相同，则long类型转换成unsigned int。</li></ol> <h2 id="显式转换"><a href="#显式转换" class="header-anchor">#</a> 显式转换</h2> <h3 id="static-cast"><a href="#static-cast" class="header-anchor">#</a> static_cast</h3> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span> new_type <span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>相当于传统的C语言里的强制转换: 把expression转换为new_type类型</p> <p>compile time检查，用于非多态的转换，可以转换指针及其他</p> <p>没有运行时类型检查来保证转换的安全性</p> <p><strong>用法</strong></p> <ol><li>用于类层次结构中基类（父类）和派生类（子类）之间指针或引用的转换。
<ol><li>进行上行转换（把派生类的指针或引用转换成基类表示）是安全的；</li> <li>进行下行转换（把基类指针或引用转换成派生类表示）时，由于没有动态类型检查，所以是不安全的。</li></ol></li> <li>用于基本数据类型之间的转换，如把int转换成char，把int转换成enum。</li> <li>把空指针转换成目标类型的空指针。</li> <li>把任何类型的表达式转换成void类型。</li></ol> <p>static_cast不能转换掉expression的const、volatile、或者__unaligned属性</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">char</span> a <span class="token operator">=</span> <span class="token char">'a'</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//正确，将char型数据转换成int型数据</span>
<span class="token keyword">double</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token operator">*</span>d <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//正确，将double指针转换成void指针</span>
<span class="token keyword">int</span> e <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> f <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> <span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//正确，将int型数据转换成const int型数据</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> g <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>h <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token operator">&amp;</span>g<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//编译错误，static_cast不能转换掉g的const属性</span>
<span class="token keyword">class</span> <span class="token class-name">Base</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span>
<span class="token punctuation">{</span><span class="token punctuation">}</span>
Base<span class="token operator">*</span> pB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>Derived<span class="token operator">*</span> pD <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Derived<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pB<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//下行转换是不安全的(坚决抵制这种方法)</span>
Derived<span class="token operator">*</span> pD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Derived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>Base<span class="token operator">*</span> pB <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Base<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pD<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//上行转换是安全的</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>任何具有明确定义的类型转换，只要不包含底层const，都可以使用static_cast。</p> <h3 id="dynamic-cast"><a href="#dynamic-cast" class="header-anchor">#</a> dynamic_cast</h3> <p>dynamic_cast 是C++对多态支持的强制类型转换。 所以class 里面必须有 virtual function； 通过运行时类型识别(RTTI)，程序能够使用基类的指针或引用来检索这些指针或引用所指对象的实际派生类型。</p> <p>与其他强制类型转换不同，dynamic_cast涉及运行时类型检查(RTTI)。 如果绑定到引用或指针的对象不是目标类型的对象，则 dynamic_cast 失败。有两种情况:</p> <ol><li>to pointer : 如果转换到指针类型的dynamic_cast失败，则dynamic_cast的结果是 0 值；</li> <li>to reference : 如果转换到引用类型的dynamic_cast失败，则抛出一个bad_cast类型的异常。</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>type<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> 	<span class="token comment">//type必须是一个类类型且必须是一个有效的指针</span>
<span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>type<span class="token operator">&amp;</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> 	<span class="token comment">//type必须是一个类类型且必须是一个左值</span>
<span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>type<span class="token operator">&amp;&amp;</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> 	<span class="token comment">//type必须是一个类类型且必须是一个右值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>expr的类型必须符合以下三个条件中的任何一个：</p> <ol><li>expr的类型是目标类型type的公有派生类</li> <li>expr的类型是目标type的共有基类</li> <li>expr的类型就是目标type的类型。</li></ol> <p>用法</p> <ul><li>dynamic_cast主要用于类层次间的上行转换和下行转换，还可以用于类之间的交叉转换（cross  cast）。</li> <li>在类层次间进行上行转换时，dynamic_cast和static_cast的效果是一样的；</li> <li>在进行下行转换时，dynamic_cast具有类型检查的功能，比static_cast更安全。</li> <li>dynamic_cast是唯一无法由旧式语法执行的动作，也是唯一可能耗费重大运行成本的转型动作。</li></ul> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">if</span><span class="token punctuation">(</span>Derived <span class="token operator">*</span>dp <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>Derived <span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>bp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//使用dp指向的Derived对象 </span>
<span class="token punctuation">}</span>
<span class="token keyword">else</span><span class="token punctuation">{</span>
    <span class="token comment">//使用bp指向的Base对象 </span>
<span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">const</span> Base <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">try</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> Derived <span class="token operator">&amp;</span>d <span class="token operator">=</span> <span class="token generic-function"><span class="token function">dynamic_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">const</span> Base <span class="token operator">&amp;</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token comment">//使用b引用的Derived对象</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>bad_cast<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//处理类型转换失败的情况</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="reinterpret-cast"><a href="#reinterpret-cast" class="header-anchor">#</a> reinterpret_cast</h3> <p>仅仅重新解释类型，但没有进行二进制的转换：</p> <p>转换的类型必须是一个指针、引用、算术类型、函数指针或者成员指针。</p> <p>在比特位级别上进行转换。它可以把一个指针转换成一个整数，也可以把一个整数转换成一个指针（先把一个指针转换成一个整数，在把该整数转换成原类型的指针，还可以得到原先的指针值）。</p> <p>最普通的用途就是在函数指针类型之间进行转换。</p> <p>很难保证移植性。</p> <p>用法可以总结如下：</p> <ol><li>去const属性用const_cast。</li> <li>基本类型转换用static_cast。</li> <li>多态类之间的类型转换用daynamic_cast。</li> <li>不同类型的指针类型转换用reinterpret_cast。</li></ol> <p>通常为运算对象的位模式提供较低层次上的重新解释。即要求编译器将两种无关联的类型作转换。</p> <ul><li>reinterpret_cast本质上依赖于机器。要想安全地使用reinterpret_cast必须对涉及的类型和编译器实现转换的过程都非常了解。</li> <li>较危险， 慎用</li></ul> <h3 id="const-cast"><a href="#const-cast" class="header-anchor">#</a> const_cast</h3> <p>这个操作符可以暂时去掉变量const属性或者volatile属性的转换符，这样就可以更改const变量了。比如下面代码</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>string str <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>_const <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//c_str()返回const char*类型，直接赋值给char *显然出错，这句话编译不能通过</span>
<span class="token keyword">char</span> <span class="token operator">*</span>_non_const <span class="token operator">=</span> <span class="token generic-function"><span class="token function">const_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//将const属性移除，可以通过编译了</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>const_cast， const_cast 只能改变运算对象的low_level const</li> <li>一旦我们去掉了某个对象的const性质，编译器就不再阻止我们对该对象进行写操作了。</li> <li>如果对象本身不是一个常量，使用强制类型转换获得写权限是合法的行为。然而如果对象是一个常量，再使用const_cast执行写操作就会产生未定义的后果。</li></ul> <h2 id="c语言中的强制类型转换"><a href="#c语言中的强制类型转换" class="header-anchor">#</a> C语言中的强制类型转换</h2> <p>在引入命名的强制类型转换操作符之前，显式强制转换用圆括号将类型括起来实现：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">char</span> <span class="token operator">*</span>pc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span> ip<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>效果与使用 reinterpret_cast 符号相同，但这种强制转换的可视性比较差，难以跟踪错误的转换。</p> <p>标准 C++ 为了加强类型转换的可视性，引入命名的强制转换操作符，为程序员在必须使用强制转换时提供了更好的工具。例如，非指针的 static_cast 和const_cast 要比 reinterpret_cast 更安全。 结果使程序员（以及读者和操纵程序的工具）可清楚地辨别代码中每个显式的强制转换潜在的风险级别。</p> <p>虽然标准 C++ 仍然支持旧式强制转换符号，但是我们建议，只有在 C 语言或标准 C++ 之前的编译器上编写代码时，才使用这种语法。  旧式强制转换符号有下列两种形式：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">type</span> <span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Function-style cast notation</span>
<span class="token punctuation">(</span>type<span class="token punctuation">)</span> expr<span class="token punctuation">;</span> <span class="token comment">// C-language-style cast notation</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>旧式强制转换依赖于所涉及的数据类型，具有与 const_cast、 static_cast 和 reinterpret_cast 一样的行为。 在合法使用 static_cast 或 const_cast 的地方，旧式强制转换提供了与各自对应的命名强制转换一样的功能。 如果这两种强制转换均不合法，则旧式强制转换执行 reinterpret_cast 功能。 例如，我们可用旧式符号重写上一节的强制转换:</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> ival<span class="token punctuation">;</span> <span class="token keyword">double</span> dval<span class="token punctuation">;</span>      
ival <span class="token operator">+=</span> <span class="token keyword">int</span> <span class="token punctuation">(</span>dval<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment">// static_cast: converts double to int</span>
<span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> pc_str<span class="token punctuation">;</span>     
<span class="token function">string_copy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>pc_str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// const_cast: casts away const</span>
<span class="token keyword">int</span> <span class="token operator">*</span>ip<span class="token punctuation">;</span>     
<span class="token keyword">char</span> <span class="token operator">*</span>pc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span>ip<span class="token punctuation">;</span>       <span class="token comment">// reinterpret_cast: treats int as char</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>支持旧式强制转换符号是为了对“在标准 C++ 之前编写的程序”保持向后兼容性，并保持与 C 语言的兼容性。</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>reinterpret_cast可以转换任意一个32bit整数，包括所有的指针和整数。可以把任何整数转成指针，也可以把任何指针转成整数，以及把指针转化为任意类型的指针，威力最为强大！但不能将非32bit的实例转成指针。总之，只要是32bit的东东，怎么转都行！</p> <p>static_cast和dynamic_cast可以执行指针到指针的转换，或实例本身到实例本身的转换，但不能在实例和指针之间转换。</p> <p>static_cast只能提供编译时的类型安全， 而dynamic_cast可以提供运行时类型安全。举个例子：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">a</span>；
<span class="token keyword">class</span> <span class="token class-name">b</span><span class="token operator">:</span><span class="token base-clause"><span class="token class-name">a</span>；
<span class="token keyword">class</span> <span class="token class-name">c</span></span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>上面三个类a是基类，b继承a，c和ab没有关系。</p> <p>有一个函数</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">function</span><span class="token punctuation">(</span>a <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在有一个对象是b的实例b，一个c的实例c。</p> <p>function(static_cast&lt;a&amp;&gt;(b)可以通过而 function(static_cast&lt;a&amp;&gt;(c))不能通过编译，因为<strong>在编译的时候编译器已经知道c和a的类型不符</strong>，因此static_cast可以保证安全。</p> <p>下面我们骗一下编译器，先把c转成类型a</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>b<span class="token operator">&amp;</span> ref_b <span class="token operator">=</span> <span class="token keyword">reinterpret_cast</span><span class="token operator">&lt;</span>b<span class="token operator">&amp;</span><span class="token operator">&gt;</span>c<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后function(static_cast&lt;a&amp;&gt;(ref_b))就通过了！因为从编译器的角度来看，在编译时并不能知道ref_b实际上是c！</p> <p><strong>function(dynamic_cast&lt;a&amp;&gt;(ref_b))编译时也能过，但在运行时失败了，因为dynamic_cast在运行时会检查ref_b的实际类型，这样就骗不过去了。</strong></p> <p>在应用多态编程时，当我们<strong>无法确定传过来的对象的实际类型时使用dynamic_cast</strong>，如果能保证对象的实际类型，用 static_cast 就可以了。</p> <ol><li>dynamic_cast:动态类型转换</li> <li>static_cast:静态类型转换</li> <li>reinterpret_cast:重新解释类型转换</li> <li>const_cast:常量类型转换</li></ol> <p>一些常规操作:</p> <ol><li>dynamic_cast 一般用在父类和子类指针或应用的互相转化;</li> <li>static_cast 一般是普通数据类型(如int m =static_cast<int>(3.14));</int></li> <li>reinterpret_cast 很像c的一般暴力类型转换操作</li> <li>const_cast 是把cosnt或volatile属性去掉</li></ol> <h2 id="static-cast-一些将会导致错误的情况。"><a href="#static-cast-一些将会导致错误的情况。" class="header-anchor">#</a> static_cast 一些将会导致错误的情况。</h2> <h4 id="泛型-generic-types"><a href="#泛型-generic-types" class="header-anchor">#</a> 泛型(Generic Types)</h4> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">float</span> f <span class="token operator">=</span> <span class="token number">12.3</span><span class="token punctuation">;</span>
<span class="token keyword">float</span> <span class="token operator">*</span>pf <span class="token operator">=</span> <span class="token operator">&amp;</span>f<span class="token punctuation">;</span>
<span class="token comment">// static cast&lt;&gt;</span>
<span class="token comment">// 成功编译, n = 12</span>
<span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 错误,指向的类型是无关的(译注：即指针变量pf是float类型，现在要被转换为int类型)</span>
<span class="token keyword">int</span><span class="token operator">*</span> pn <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//成功编译</span>
<span class="token keyword">void</span><span class="token operator">*</span> pv <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span><span class="token operator">*</span> pn2 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//成功编译, 但是 *pn2是无意义的内存(rubbish)</span>
<span class="token comment">// reinterpret_cast&lt;&gt;</span>

<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">//错误,编译器知道你应该调用static_cast&lt;&gt;</span>
<span class="token keyword">int</span><span class="token operator">*</span> pi <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pf<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//成功编译, 但是 *pi 实际上是无意义的内存,和 *pn2一样</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>简而言之，static_cast&lt;&gt; 将尝试转换，举例来说，如float-到-integer，而reinterpret_cast&lt;&gt;将<strong>改变编译器的意图重新将对象作为另一类型来处理</strong></p> <h4 id="指针类型-pointer-types"><a href="#指针类型-pointer-types" class="header-anchor">#</a> 指针类型(Pointer Types)``</h4> <p>指针转换有点复杂，后面其情况都会使用下面的类：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">CBaseX</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">int</span> x<span class="token punctuation">;</span>
        <span class="token function">CBaseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">void</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseX::foo() x =%d/n&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CBaseY</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
        <span class="token keyword">int</span> y<span class="token punctuation">;</span>
        <span class="token keyword">int</span><span class="token operator">*</span> py<span class="token punctuation">;</span>
        <span class="token function">CBaseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> y <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> py <span class="token operator">=</span> <span class="token operator">&amp;</span>y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseY::bar() y =%d, *py =%d/n&quot;</span><span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token operator">*</span>py<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">CDerived</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CBaseX</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">CBaseY</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span><span class="token operator">:</span>
    	<span class="token keyword">int</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h5 id="情况1-两个无关的类之间的转换"><a href="#情况1-两个无关的类之间的转换" class="header-anchor">#</a> 情况1：两个无关的类之间的转换</h5> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// Convert between CBaseX* and CBaseY*</span>
<span class="token comment">// CBaseX* 和 CBaseY*之间的转换</span>
CBaseX<span class="token operator">*</span> pX <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CBaseX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error, types pointed to are unrelated</span>
CBaseY<span class="token operator">*</span> pY1 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CBaseY<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Compile OK, but pY2 is not CBaseX</span>

CBaseY<span class="token operator">*</span> pY2 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CBaseY<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// System crash!!!</span>
<span class="token comment">// pY2-&gt;bar();</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>正如我们在泛型例子中所认识到的，如果你尝试转换一个对象到另一个无关的类static_cast&lt;&gt;将失败，而reinterpret_cast&lt;&gt;就总是成功“欺骗”编译器：那个对象就是那个无关类。但是在运行的时候由于编译器对被转换的对象会发生错误的解释, 程序会crash掉.</p> <h5 id="情况2-转换到相关的类"><a href="#情况2-转换到相关的类" class="header-anchor">#</a> 情况2：转换到相关的类</h5> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>CDerived<span class="token operator">*</span> pD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CDerived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CDerived* pD = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pD<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// static_cast&lt;&gt; CDerived* -&gt; CBaseY* -&gt; CDerived*</span>
CBaseY<span class="token operator">*</span> pY1 <span class="token operator">=</span> pD<span class="token punctuation">;</span> <span class="token comment">//成功编译，隐式static_cast&lt;&gt;转换</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseY* pY1 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pY1<span class="token punctuation">)</span><span class="token punctuation">;</span>

CDerived<span class="token operator">*</span> pD1 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CDerived<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pY1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 成功编译, 现在 pD1 = pD</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CDerived* pD1 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pD1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// reinterpret_cast</span>
CBaseY<span class="token operator">*</span> pY2 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">reinterpret_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CBaseY<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pD<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 成功编译, 但是 pY2 不是 CBaseY*</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseY* pY2 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pY2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 无关的 static_cast&lt;&gt;</span>
CBaseY<span class="token operator">*</span> pY3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CBaseY</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseY* pY3 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pY3<span class="token punctuation">)</span><span class="token punctuation">;</span>

CDerived<span class="token operator">*</span> pD3 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CDerived<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pY3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 成功编译,尽管 pY3 只是一个 &quot;新 CBaseY()&quot;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CDerived* pD3 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pD3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>---------------------- output ---------------------------</p> <p>​    CDerived* pD = 392fb8</p> <p>​    CBaseY* pY1 = 392fbc</p> <p>​    CDerived* pD1 = 392fb8</p> <p>​    CBaseY* pY2 = 392fb8</p> <p>​    CBaseY* pY3 = 390ff0</p> <p>​    CDerived* pD3 = 390fec</p> <p>注意：在将CDerived用隐式 static_cast&lt;&gt;转换到CBaseY(第5行)时，结果是(指向)CDerived*(的指针向后) 偏移了4(个字节)(译注：4为int类型在内存中所占字节数)。为了知道static_cast&lt;&gt; 实际如何，我们不得不要来看一下CDerived的内存布局。</p> <p>CDerived的内存布局包括两个对象，CBaseX 和 CBaseY，编译器也知道这一点。因此，当将CDerived* 转换到 CBaseY时，它给指针添加4个字节，同时当你将CBaseY转换到CDerived*时，它给指针减去4。然而，甚至它即便不是一个CDerived你也可以这样做。</p> <p>当然，这个问题只在如果你做了多继承时发生。在你将CDerived转换 到 CBaseX时static_cast&lt;&gt; 和 reinterpret_cast&lt;&gt;是没有区别的。</p> <h5 id="情况3-void之间的向前和向后转换"><a href="#情况3-void之间的向前和向后转换" class="header-anchor">#</a> 情况3：void之间的向前和向后转换</h5> <p>因为任何指针可以被转换到void，而void*可以被向后转换到任何指针(对于static_cast&lt;&gt; 和 reinterpret_cast&lt;&gt;转换都可以这样做)，如果没有小心处理的话错误可能发生。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>CDerived<span class="token operator">*</span> pD <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CDerived</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CDerived* pD = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pD<span class="token punctuation">)</span><span class="token punctuation">;</span>
CBaseY<span class="token operator">*</span> pY <span class="token operator">=</span> pD<span class="token punctuation">;</span> <span class="token comment">// 成功编译, pY = pD + 4</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CBaseY* pY = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pY<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span><span class="token operator">*</span> pV1 <span class="token operator">=</span> pY<span class="token punctuation">;</span> <span class="token comment">//成功编译, pV1 = pY</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;void* pV1 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pV1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// pD2 = pY, 但是我们预期 pD2 = pY - 4</span>
CDerived<span class="token operator">*</span> pD2 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span>CDerived<span class="token operator">*</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>pV1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;CDerived* pD2 = %x/n&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>pD2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// pD2-&gt;bar();// 系统崩溃</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>---------------------- 输出 ---------------------------</p> <p>CDerived* pD = 392fb8</p> <p>CBaseY* pY = 392fbc</p> <p>void* pV1 = 392fbcd</p> <p>CDerived* pD2 = 392fbc</p> <p>一旦我们已经转换指针为void，我们就不能轻易将其转换回原类。在上面的例子中，从一个void 返回CDerived<em>的唯一方法是将其转换为CBaseY</em>然后再转换为CDerived。 但是如果我们不能确定它是CBaseY* 还是 CDerived*，这时我们不得不用dynamic_cast&lt;&gt; 或typeid[2]。</p> <p>注释：</p> <ol><li><p>dynamic_cast&lt;&gt;,  从另一方面来说，可以防止一个泛型CBaseY* 被转换到CDerived*。</p></li> <li><p>dynamic_cast&lt;&gt;,  需要类成为多态，即包括“虚”函数，并因此而不能成为void*。</p></li></ol></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=C%2B%2B" title="标签">#C++</a></div> <div class="last-updated"><span class="prefix">Last updated:</span> <span class="time">2023/03/11, 03:13:10</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/8744f7/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">C++ Glimpse</div></a> <a href="/pages/ab4daf/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">typedef</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/8744f7/" class="prev">C++ Glimpse</a></span> <span class="next"><a href="/pages/ab4daf/">typedef</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:quincy_jet@outlook.com" title="E-Mail" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Quincy-J" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
    Copyright © 2017-2023
    <span>Quincy Jet | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          Auto 
        </li><li class="iconfont icon-rijianmoshi">
          Light 
        </li><li class="iconfont icon-yejianmoshi">
          Dark 
        </li><li class="iconfont icon-yuedu">
          Read
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0156df4b.js" defer></script><script src="/assets/js/2.0eed2333.js" defer></script><script src="/assets/js/3.1c18827c.js" defer></script><script src="/assets/js/10.20339081.js" defer></script>
  </body>
</html>
