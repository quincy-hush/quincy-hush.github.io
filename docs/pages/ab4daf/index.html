<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>typedef | 1ms Faster</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/more.png">
    <meta name="description" content="Software performace profile/analysis/optimization">
    <meta name="keywords" content="optimization, analysis, profile, performance, latency, throughput, metrics, linux, cache, CPU, architecture">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.e5fe63c7.css" as="style"><link rel="preload" href="/assets/js/app.094f6ec8.js" as="script"><link rel="preload" href="/assets/js/2.0eed2333.js" as="script"><link rel="preload" href="/assets/js/3.1c18827c.js" as="script"><link rel="preload" href="/assets/js/11.9e667a20.js" as="script"><link rel="prefetch" href="/assets/js/10.20339081.js"><link rel="prefetch" href="/assets/js/12.e10ed919.js"><link rel="prefetch" href="/assets/js/13.5b153336.js"><link rel="prefetch" href="/assets/js/14.c9818bab.js"><link rel="prefetch" href="/assets/js/15.e1d4e55a.js"><link rel="prefetch" href="/assets/js/16.b5733294.js"><link rel="prefetch" href="/assets/js/17.6ebbc744.js"><link rel="prefetch" href="/assets/js/18.70850c97.js"><link rel="prefetch" href="/assets/js/19.58d5cecb.js"><link rel="prefetch" href="/assets/js/20.8bcfd87e.js"><link rel="prefetch" href="/assets/js/21.b607bcc6.js"><link rel="prefetch" href="/assets/js/22.bbfb5196.js"><link rel="prefetch" href="/assets/js/23.ca136498.js"><link rel="prefetch" href="/assets/js/24.c1071b43.js"><link rel="prefetch" href="/assets/js/25.8fc4c91b.js"><link rel="prefetch" href="/assets/js/26.fa3e35c7.js"><link rel="prefetch" href="/assets/js/27.2352de48.js"><link rel="prefetch" href="/assets/js/28.b1b04dc7.js"><link rel="prefetch" href="/assets/js/29.dde3b6c9.js"><link rel="prefetch" href="/assets/js/30.99e62fa7.js"><link rel="prefetch" href="/assets/js/31.8155bf2b.js"><link rel="prefetch" href="/assets/js/32.60a19602.js"><link rel="prefetch" href="/assets/js/33.699a2b94.js"><link rel="prefetch" href="/assets/js/34.aaf5074b.js"><link rel="prefetch" href="/assets/js/4.5c1dc4ce.js"><link rel="prefetch" href="/assets/js/5.d89070b9.js"><link rel="prefetch" href="/assets/js/6.1e60fa96.js"><link rel="prefetch" href="/assets/js/7.dd5c479a.js"><link rel="prefetch" href="/assets/js/8.ae517688.js"><link rel="prefetch" href="/assets/js/9.77bda456.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e5fe63c7.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">1ms Faster</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Wiki" class="dropdown-title"><a href="/wiki/" class="link-title">Wiki</a> <span class="title" style="display:none;">Wiki</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Program</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/lean_in_c++/" class="nav-link">Lean in C++</a></li></ul></li><li class="dropdown-item"><h4>Perfromance Engineering</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Performance_Engineering/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>Reading Note</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Reading_Notes/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>ComputeArch</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>Compiler</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>System</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/authoring/" class="nav-link">Authoring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li></ul></div></div> <a href="https://github.com/Quincy-J" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/github_profile_2_1.jpg"> <div class="blogger-info"><h3>Quincy Jet</h3> <span>We are.</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Wiki" class="dropdown-title"><a href="/wiki/" class="link-title">Wiki</a> <span class="title" style="display:none;">Wiki</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Program</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/lean_in_c++/" class="nav-link">Lean in C++</a></li></ul></li><li class="dropdown-item"><h4>Perfromance Engineering</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Performance_Engineering/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>Reading Note</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wiki/Reading_Notes/" class="nav-link">[&gt;&gt;&gt;&gt;&gt;]</a></li></ul></li><li class="dropdown-item"><h4>ComputeArch</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>Compiler</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li><li class="dropdown-item"><h4>System</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/ab4daf/404" class="nav-link">[_]</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/authoring/" class="nav-link">Authoring</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Archives" class="dropdown-title"><a href="/archives/" class="link-title">Archives</a> <span class="title" style="display:none;">Archives</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">Categories</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">Tags</a></li></ul></div></div> <a href="https://github.com/Quincy-J" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Lean in c++</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki/lean_in_c++/" class="sidebar-link">Lean in C++</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>Phase_0:Glimpse</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/8744f7/" class="sidebar-link">C++ Glimpse</a></li><li><a href="/pages/409de3/" class="sidebar-link">type cast</a></li><li><a href="/pages/ab4daf/" aria-current="page" class="active sidebar-link">typedef</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/ab4daf/#定义一种类型的别名" class="sidebar-link">定义一种类型的别名</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef-定义基础类型-int-long" class="sidebar-link">typedef 定义基础类型，int，  long</a></li><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef-定义复合类型-如指针和数组。" class="sidebar-link">typedef 定义复合类型，如指针和数组。</a></li><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef定义struct类型" class="sidebar-link">typedef定义struct类型</a></li><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef-有const的情况" class="sidebar-link">typedef 有const的情况</a></li><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef-与-define的区别" class="sidebar-link">typedef 与 #define的区别</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/ab4daf/#简化复杂的声明" class="sidebar-link">简化复杂的声明</a></li><li class="sidebar-sub-header level2"><a href="/pages/ab4daf/#跨平台类型定义" class="sidebar-link">跨平台类型定义</a></li><li class="sidebar-sub-header level2"><a href="/pages/ab4daf/#注意事项" class="sidebar-link">注意事项：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/ab4daf/#typedef是一个存储类的关键字" class="sidebar-link">typedef是一个存储类的关键字</a></li></ul></li></ul></li><li><a href="/pages/2b0a8f/" class="sidebar-link">class vs. typename</a></li><li><a href="/pages/b9de04/" class="sidebar-link">const</a></li><li><a href="/pages/5bac8e/" class="sidebar-link">extern</a></li><li><a href="/pages/c08a6e/" class="sidebar-link">pointer</a></li><li><a href="/pages/9b131d/" class="sidebar-link">static</a></li><li><a href="/pages/598385/" class="sidebar-link">volatile</a></li><li><a href="/pages/91242f/" class="sidebar-link">inline</a></li><li><a href="/pages/efbaf4/" class="sidebar-link">assert</a></li><li><a href="/pages/b4d0b6/" class="sidebar-link">void</a></li><li><a href="/pages/fc5419/" class="sidebar-link">__global__</a></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Performance Engineering</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Misc</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Reading Notes</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06970110><div class="articleInfo" data-v-06970110><ul class="breadcrumbs" data-v-06970110><li data-v-06970110><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06970110></a></li> <li data-v-06970110><a href="/wiki/#Wiki" data-v-06970110>Wiki</a></li><li data-v-06970110><a href="/wiki/#Lean in c++" data-v-06970110>Lean in c++</a></li><li data-v-06970110><a href="/wiki/#Phase_0:Glimpse" data-v-06970110>Phase_0:Glimpse</a></li></ul> <div class="info" data-v-06970110><div title="作者" class="author iconfont icon-touxiang" data-v-06970110><a href="https://github.com/Quincy-J" target="_blank" title="作者" class="beLink" data-v-06970110>Quincy Jet</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06970110><a href="javascript:;" data-v-06970110>2021-08-05</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">Content</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">typedef<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>一些大程序里面， 很多时候上来先用typedef定义了很多struct， enum或者union类型， 我们先看看typedef这个关键字</p> <h2 id="定义一种类型的别名"><a href="#定义一种类型的别名" class="header-anchor">#</a> 定义一种类型的别名</h2> <h3 id="typedef-定义基础类型-int-long"><a href="#typedef-定义基础类型-int-long" class="header-anchor">#</a> typedef 定义基础类型，int，  long</h3> <p>typedef 使用最多的地方是创建易于记忆的类型名，例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">long</span> byte_4<span class="token punctuation">;</span>  <span class="token comment">// 给已知数据类型long起个新名字，叫byte_4。 </span>
<span class="token keyword">void</span> <span class="token function">measure</span><span class="token punctuation">(</span>size <span class="token operator">*</span> psz<span class="token punctuation">)</span><span class="token punctuation">;</span> 
size array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
size len <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getlength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
std<span class="token double-colon punctuation">::</span>vector<span class="token operator">&lt;</span>size<span class="token operator">&gt;</span> vs<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里定义了一个 int 的同义字，名为 size， typedef 并不创建新的类型。它仅为现有类型添加一个同义字。你可以在需要 int 的地方使用 size：</p> <h3 id="typedef-定义复合类型-如指针和数组。"><a href="#typedef-定义复合类型-如指针和数组。" class="header-anchor">#</a> typedef 定义复合类型，如指针和数组。</h3> <p>例如，像下面这样重复定义有 81 个字符元素的数组：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">char</span> line<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> text<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>可以使用typedef定义相同类型和大小的数组，可以这样：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span> Line<span class="token punctuation">[</span><span class="token number">81</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
Line text<span class="token punctuation">,</span> secondline<span class="token punctuation">;</span>
<span class="token function">getline</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>也可以用typedef定义一个指针类型：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> pa<span class="token punctuation">,</span> pb<span class="token punctuation">;</span>         <span class="token comment">// 这是不对的，它只声明了一个指向字符变量的指针, 和一个字符变量；</span>
<span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span> pstr<span class="token punctuation">;</span>  <span class="token comment">// 可以这样</span>
pstr pa<span class="token punctuation">,</span> pb<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">mystrcmp</span><span class="token punctuation">(</span>pstr<span class="token punctuation">,</span> pstr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>但是这里也有一些陷阱。标准函数 strcmp()有两个‘const char *’类型的参数。因此，它可能会误导我们象下面这样声明 mystrcmp()：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">mystrcmp</span><span class="token punctuation">(</span><span class="token keyword">const</span> pstr<span class="token punctuation">,</span> <span class="token keyword">const</span> pstr<span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这是错误的，按照顺序，‘const pstr’被解释为‘char * const’（一个指向 char 的常量指针），而不是‘const char *’（指向常量 char 的指针）。这个问题很容易解决：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span> cpstr<span class="token punctuation">;</span> 
<span class="token keyword">int</span> <span class="token function">mystrcmp</span><span class="token punctuation">(</span>cpstr<span class="token punctuation">,</span> cpstr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 现在是正确的</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>记住： 不管什么时候，只要为指针声明 typedef，那么都要在 typedef 名称中加一个 const，以使得该指针所指数据为常量量（常量指针），而指针本身为常量（指针常量）。</p> <h3 id="typedef定义struct类型"><a href="#typedef定义struct类型" class="header-anchor">#</a> typedef定义struct类型</h3> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tagMyStruct</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">int</span> iNum<span class="token punctuation">;</span> 
    <span class="token keyword">long</span> lLength<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> MyStruct<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这语句实际上完成以下两个操作：</p> <p>1）定义一个新的struct</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">tagMyStruct</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">int</span> iNum<span class="token punctuation">;</span> 
    <span class="token keyword">long</span> lLength<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>分析：tagMyStruct称为“tag”，即“标签”，实际上是一个临时名字，struct 关键字和tagMyStruct一起，构成了这个结构类型，不论是否有typedef，这个结构都存在。</p> <p>我们可以用struct tagMyStruct varName来定义变量，但要注意，<strong>使用tagMyStruct varName来定义变量是不对的，因为struct 和tagMyStruct合在一起才能表示一个结构类型。</strong></p> <p>2）typedef为这个新的结构起了一个名字，叫MyStruct。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tagMyStruct</span> MyStruct<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>因此，MyStruct实际上相当于struct tagMyStruct，我们可以使用MyStruct varName来定义变量。</p> <p>3）规范做法：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">tagNode</span> 
<span class="token punctuation">{</span> 
    <span class="token keyword">char</span> <span class="token operator">*</span>pItem<span class="token punctuation">;</span> 
    <span class="token keyword">struct</span> <span class="token class-name">tagNode</span> <span class="token operator">*</span>pNext<span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">tagNode</span> <span class="token operator">*</span>pNode<span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>除了对struct， 在一些代码中经常看到对enum， union来进行typedef， 来形成整个程序的类型系统。</p> <h3 id="typedef-有const的情况"><a href="#typedef-有const的情况" class="header-anchor">#</a> typedef 有const的情况</h3> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span><span class="token operator">*</span> PSTR<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">mystrcmp</span><span class="token punctuation">(</span><span class="token keyword">const</span> PSTR<span class="token punctuation">,</span> <span class="token keyword">const</span> PSTR<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>const PSTR实际上相当于const char<em>吗？不是的，它实际上相当于char</em> const。</p> <p>原因在于const给予了整个指针本身以常量性，也就是形成了常量指针char* const。</p> <p>简单来说，当const和typedef一起出现时，typedef不再是简单的字符串替换。</p> <p>下面的代码中编译器会报一个错误</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span> pStr<span class="token punctuation">;</span> 
<span class="token keyword">char</span> string<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span> 
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> string<span class="token punctuation">;</span> 
<span class="token keyword">const</span> pStr p2 <span class="token operator">=</span> string<span class="token punctuation">;</span> 
p1<span class="token operator">++</span><span class="token punctuation">;</span> 
p2<span class="token operator">++</span><span class="token punctuation">;</span>  <span class="token comment">// error!  const pStr p2并不等于const char * p2。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面代码中const pStr p2和const long x本质上没有区别，都是对变量进行只读限制，只不过此处变量p2的数据类型是我们自己定义的而不是系统固有类型而已。const pStr p2的真正含义是：限定数据类型为char *的变量p2为只读，因此p2++错误。</p> <h3 id="typedef-与-define的区别"><a href="#typedef-与-define的区别" class="header-anchor">#</a> typedef 与 #define的区别</h3> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">char</span><span class="token operator">*</span> pa<span class="token punctuation">,</span> pb<span class="token punctuation">;</span>         <span class="token comment">// 这是不对的，它只声明了一个指向字符变量的指针, 和一个字符变量；</span>
<span class="token comment">// #define char* pstr // 如果是这样则是不对的， 因为#define只是等价替换祖父穿， 对于第二个pb则仍然为char类型</span>
<span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span> pstr<span class="token punctuation">;</span>  <span class="token comment">// 可以这样</span>
pstr pa<span class="token punctuation">,</span> pb<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">mystrcmp</span><span class="token punctuation">(</span>pstr<span class="token punctuation">,</span> pstr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>#define只是在预处理的时候进行简单的字符串替换， typedef是重新在整个程序中定义一个新的类型</p> <p>不仅仅如此：</p> <ol><li>#define宏定义有一个特别的长处：可以使用 #ifdef ,#ifndef等来进行逻辑判断，还可以使用#undef来取消定义。</li> <li>typedef也有一个特别的长处：它符合范围规则，使用typedef定义的变量类型其作用范围限制在所定义的函数或者文件内（取决于此变量定义的位置），而宏定义则没有这种特性。</li></ol> <h2 id="简化复杂的声明"><a href="#简化复杂的声明" class="header-anchor">#</a> 简化复杂的声明</h2> <p>在原来的声明里逐步用别名替换一部分复杂声明，如此循环，把带变量名的部分留到最后替换，得到的就是原声明的最简化版。举例：</p> <ol><li>原声明：</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 含有5个函数指针组成的数组</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	变量名为a，也可以直接用一个新别名 pFun 替换a就可以了：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>pFun<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
pFun a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//  原声明使用pFun表示</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>原声明：</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	变量名为b，先替换右边部分括号里的，pFunParam为别名一：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFunParam<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	再替换左边的变量b，pFunx为别名二：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code> <span class="token keyword">typedef</span> <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFunx<span class="token punctuation">)</span><span class="token punctuation">(</span>pFunParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	原声明的最简化版：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>pFunx b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>原声明：</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">doube</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span>e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	变量名为e，先替换左边部分，pFuny为别名一：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token operator">*</span>pFuny<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	再替换右边的变量e，pFunParamy为别名二</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token function">pFuny</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFunParamy<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	原声明的最简化版：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>pFunParamy e<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>原声明：</li></ol> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>   <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">*</span>pa<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 此蓝色部分为个人理解，未找到原文出处 </span>

　<span class="token keyword">typedef</span> <span class="token keyword">double</span><span class="token punctuation">(</span><span class="token operator">*</span>pFun<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//首先为上面表达式蓝色部分声明一个新类型 </span>
　<span class="token keyword">typedef</span> <span class="token function">pFun</span> <span class="token punctuation">(</span><span class="token operator">*</span>pFunParam<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">//整体声明一个新类型 </span>
　pFunParam pa<span class="token punctuation">;</span>       <span class="token comment">//使用定义的新类型来声明对象，等价于double(*(*pa)[9])(); </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>理解复杂声明可用的“右左法则”：</p> <p>从变量名看起，先往右，再往左，碰到一个圆括号就调转阅读的方向；括号内分析完就跳出括号，还是按先右后左的顺序，如此循环，直到整个声明分析完。举例：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>func<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>首先找到变量名func，外面有一对圆括号，而且左边是一个*号，*这说明func是一个指针；然后跳出这个圆括号，先看右边，又遇到圆括号，这说明 (func)<em>是一个函数，所以func是一个指向这类函数的指针，即函数指针，这类函数具有int</em>类型的形参，返回值类型是int。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>func<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>func 右边是一个[]运算符，说明func是具有5个元素的数组；func的左边有一个*，说明func的元素是指针（注意这里的<em>不是修饰func，而是修饰 func[5]的，原因是[]运算符优先级比</em>高，func先跟[]结合）。跳出这个括号，看右边，又遇到圆括号，说明func数组的元素是函数类型的指 针，它指向的函数具有int*类型的形参，返回值类型为int。</p> <p>也可以归纳为2个固定的模式：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token function">type</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> <span class="token comment">//函数指针 </span>
<span class="token function">type</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token comment">//数组指针</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面讨论的 typedef 行为有点像 #define 宏，用其实际类型替代同义字。不同点是 typedef 在编译时被解释，因此让编译器来应付超越预处理器能力的文本替换。例如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>PF<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这个声明引入了 PF 类型作为函数指针的同义字，该函数有两个 const char * 类型的参数以及一个 int 类型的返回值。如果要使用下列形式的函数声明，那么上述这个 typedef 是不可或缺的：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>PF <span class="token function">Register</span><span class="token punctuation">(</span>PF pf<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Register() 的参数是一个 PF 类型的回调函数，返回某个函数的地址，其署名与先前注册的名字相同。做一次深呼吸。下面我展示一下如果不用 typedef，我们是如何实现这个声明的：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">Register</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>很少有程序员理解它是什么意思，更不用说这种费解的代码所带来的出错风险了。显然，这里使用 typedef 不是一种特权，而是一种必需。持怀疑态度的人可能会问：“OK，有人还会写这样的代码吗？”，快速浏览一下揭示 signal()函数的头文件 <csinal>，一个有同样接口的函数。</csinal></p> <h2 id="跨平台类型定义"><a href="#跨平台类型定义" class="header-anchor">#</a> 跨平台类型定义</h2> <p>定义一个叫 REAL 的浮点类型，为：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">long</span> <span class="token keyword">double</span> REAL<span class="token punctuation">;</span>  <span class="token comment">// 在目标平台一上，让它表示最高精度的类型</span>
<span class="token keyword">typedef</span> <span class="token keyword">double</span> REAL<span class="token punctuation">;</span> 	   <span class="token comment">// 在不支持 long double 的平台二上</span>
<span class="token keyword">typedef</span> <span class="token keyword">float</span> REAL<span class="token punctuation">;</span>  	   <span class="token comment">// 在连 double 都不支持的平台三上，可以这样定义</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>当在不同的平台时，只要修改 typedef 本身就行，不用对代码其他部分作修改。这个微小的变动可以通过<strong>条件编译</strong>来自动实现。</p> <p>标准库广泛使用了这个技巧，比如size_t。</p> <p>此外，因为typedef是定义了一种类型的别名，不是简单的字符串替换（#define），所以它比宏更<strong>稳健（虽然用宏有时也可以完成以上的用途）。</strong></p> <h2 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项：</h2> <h3 id="typedef是一个存储类的关键字"><a href="#typedef是一个存储类的关键字" class="header-anchor">#</a> typedef是一个<strong>存储类的关键字</strong></h3> <p>同auto、extern、mutable、static、register等一样，他们在语法上是一个<strong>存储类的关键字</strong>， 虽然它并不真正影响对象的存储特性，如：</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">static</span> <span class="token keyword">int</span> INT2<span class="token punctuation">;</span>  <span class="token comment">// error</span>
<span class="token keyword">typedef</span> <span class="token keyword">register</span> <span class="token keyword">int</span> FAST_COUNTER<span class="token punctuation">;</span> <span class="token comment">// error</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>编译将失败，会提示“指定了<strong>一个以上的存储类</strong>”。。因为符号 typedef 已经占据了存储类关键字的位置，在 typedef 声明中不能用 register（或任何其它存储类关键字）。s</p> <p>Extra Reference： <a href="https://blog.fearcat.in/a?ID=00050-01af8589-5466-44dc-aa0f-462786fdca96" target="_blank" rel="noopener noreferrer">Using typedef to Curb Miscreant Code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> [使用 typedef 抑制劣质代码]</p></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=C%2B%2B" title="标签">#C++</a></div> <div class="last-updated"><span class="prefix">Last updated:</span> <span class="time">2023/03/11, 03:13:10</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/409de3/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">type cast</div></a> <a href="/pages/2b0a8f/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">class vs. typename</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/409de3/" class="prev">type cast</a></span> <span class="next"><a href="/pages/2b0a8f/">class vs. typename</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:quincy_jet@outlook.com" title="E-Mail" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Quincy-J" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
    Copyright © 2017-2023
    <span>Quincy Jet | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          Auto 
        </li><li class="iconfont icon-rijianmoshi">
          Light 
        </li><li class="iconfont icon-yejianmoshi">
          Dark 
        </li><li class="iconfont icon-yuedu">
          Read
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.094f6ec8.js" defer></script><script src="/assets/js/2.0eed2333.js" defer></script><script src="/assets/js/3.1c18827c.js" defer></script><script src="/assets/js/11.9e667a20.js" defer></script>
  </body>
</html>
